---
title: "ETC5513_Assignment_1"
author: "Mey Siv"
editor: visual
format: 
  html: 
    theme: cerulean
  pdf: default
execute:
    echo: true
    warning: false
    message: false
---

```{r}
#| message: false
#| warning: false
#| echo: false

library(dplyr)
library(ggplot2)
library(palmerpenguins)
library(tidyr)
```

# Water Insecurity

## Introduction

Water sanitation is a fundamental requirement for human survival. However, in reality, many people in certain regions still struggle to achieve water security due to factors such as demographic characteristics, living conditions, and socioeconomic status. This research uses data from the American Community Survey of the U.S Census Bureau, focusing on the 2023 "Unequal Access to Water" visualization. The goal is to examine social vulnerability indicators in the Western U.S., particularly looking at the number of households and the percentage of people with access to plumbing facilities for clean water.

## Reaserch Question

1.  which state in the U.S. is experiencing the greatest lack of plumbing facilities in 2023?
2.  which state in the U.S. is experiencing the least lack of plumbing facilities in 2023?
3.  Do areas with the largest population tend to experience a lack of plumbing facilities in 2023?

## Dataset Introduction

The water insecurity (@lst-water-insecurity) data measures the accessibility of clean water in the countries of the Western U.S. in 2023. More specifically, it looks at the number of plumbing facilities available in relation to the total population of countries in the U.S.

See @tbl-summary for variable names in the water insecurity dataset.

```{r}
#| lst-label: "lst-water-insecurity"
#| lst-cap: "Code to produce water insecurity dataset"
# read the data directly from the API 
water_insecurity_2023 <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-01-28/water_insecurity_2023.csv')
```

```{r}
#| message: false
#| warning: false
#| echo: false
#| results: 'hide'
# check the size of the dataset 
object.size(water_insecurity_2023)                   # Size in bytes
format(object.size(water_insecurity_2023), units = "MB") # Size in MB
```

```{r}
#| label: tbl-summary
#| tbl-cap: "Summary Water Insecurity dataset"
knitr::kable(summary(water_insecurity_2023))
```

### Dateset Description

```{r}

# column
ncol(water_insecurity_2023)
# row
nrow(water_insecurity_2023)

```

```{r}
knitr::include_graphics("Images/Screen Shot 2025-04-06 at 1.23.19 pm.png")

```

The water insecurity dataset has `r ncol(water_insecurity_2023)` variables and `r nrow(water_insecurity_2023)` observations.

```{r}
# display the first two rows of the dataset 
head(water_insecurity_2023, c(2))

```

## Results

```{r}
# cleaning and tidy up the data
water_insecurity_2023 <- water_insecurity_2023 %>%
  separate(name, into = c("county", "state"), sep = ", ", remove = TRUE)

```

```{r}
#| label: fig-state
#| fig-cap: "states and the percentage of lacking plumbing"

ggplot(water_insecurity_2023, 
       aes(x = reorder(state, percent_lacking_plumbing), 
           y = percent_lacking_plumbing)) +
  geom_col(fill = "#2c7fb8") +
  coord_flip() +
  labs(
    title = "Percentage of Population Lacking Plumbing by State",
    x = "State",
    y = "% Lacking Plumbing"
  ) +
  theme_minimal()
```

@fig-state shows the relationship between each state and the percentage of the population lacking plumbing facilities. \* \_Arizona has the highest percentage of the population lacking plumbing facilities, suggesting significant vulnerability to water insecurity. \* \_South Dakota has the lowest percentage of the population lacking plumbing facilities, stating that state have better access to clean water facilities.

```{r}
#| label: fig-population
#| fig-cap: "Population and number of plumbing"

water_insecurity_2023 <- water_insecurity_2023 %>%
  filter(!is.na(plumbing), !is.na(total_pop))


water_insecurity_2023_scaled <- water_insecurity_2023 %>%
  mutate(
    plumbing_scaled = scale(plumbing),
    total_pop_scaled = scale(total_pop)
  )

# Plotting the scaled data
ggplot(water_insecurity_2023_scaled, aes(x = total_pop_scaled, y = plumbing_scaled)) +
  geom_point(color = "#2c7fb8") + # Scatter plot
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Linear regression line
  labs(
    title = "Scaled Relationship between Population and Number of Plumbing",
    y = "Scaled Number of Plumbing",
    x = "Scaled Population"
  ) +
  theme_minimal()

```

@fig-population shows the relationship between the population size and the number of hosueholds with plumbing facilities. \* \_There appears to be a linear relationship between the population size and the number of hosueholds with plumbing facilities, indicating a potential trend where larger population may struggle with water access. \* \_Large population size in the region tend to experience more inadequate plumbing, which might correlate with overcrowded or underfunded infrastructure.

## Appendix

I have used Chatgpt to help me generating R code and checking my grammar. The link to my queries can be found [here](https://chatgpt.com/share/67f22b9d-5380-8003-862f-5c6a723ede48).
